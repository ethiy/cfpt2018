\documentclass[a4paper,french]{article}
\usepackage{rfiap2018_resume}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{babel}
\usepackage{times, fourier}

\usepackage{array}
\newcolumntype{x}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
\usepackage{tabulary}
\usepackage{booktabs}
\usepackage{multirow}


\usepackage{siunitx}

\usepackage{standalone}

\usepackage{enumitem}

\usepackage{amsmath}

\usepackage{float, wrapfig}
\usepackage[tablename=Tab.]{caption}

\newcounter{SubFigCounter}
\setcounter{SubFigCounter}{1}

\begin{document}
    \date{}
    \title{
        \Large\bf \'Evaluation sémantique de modèles $3D$ de bâtiments
    }
    \author{
        \begin{tabular}[t]{c@{\extracolsep{4em}}c@{\extracolsep{4em}}c@{\extracolsep{4em}}c}
            Oussama Ennafii${}^1$ & Arnaud Le Bris${}^1$ & Florent Lafarge${}^2$ & Clément Mallet${}^1$ \\
        \end{tabular}
        {}\\
        \\
        ${}^1$        Univ. Paris-Est, LaSTIG MATIS, IGN, ENSG, 94160 Saint-Mandé, France\\
        ${}^2$        Inria, Titane, 06902 Sophia Antipolis, France
        {}\\
        \\
        oussama.ennafii@ign.fr\\
    }
    \maketitle
    \thispagestyle{empty}

    \section{Introduction}
    Les modèles $3D$ urbains ont un large champ d'application~\cite{Biljecki2015}. En conséquence, la reconstruction automatique de scènes urbaines est l'objet d'intérêt de la communauté scientifique autant que les industriels~\cite{Musialski2012}. Cependant, aucun algorithme existant n'est viable du point de vue opérationnel.\\
    Notre travail s'intéresse à l'évaluation sémantique de modèle polyédriques urbains à un niveau de détails ($LoD$) prédéfinis~\cite{kolbe2005citygml}. Il s'agit de \textit{modèle} $3D$ résultant d'une méthode de reconstruction urbaine, bâtiment par bâtiment. Un modèle reconstruit au niveau $LoD 1$ est une extrusion de bâtiment. Une modélisation de niveau $LoD 2$ correspond à une simplification géométrique du bâtiment. Ce niveau ignore les superstructures (comme cheminées ou chiens assis) qui sont prises en compte à partir du niveau $LoD 3$. Le $LoD$ des modèles varie selon les applications et la résolution spatiale des données en entrée.\\
    L'évaluation sémantique de reconstructions urbaines reste mal étudiée. Cela consiste à détecter et caractériser les erreurs qui peuvent affecter les modèles $3D$ de bâtiments. Ces méthodes de diagnostic pourraient être utilisées pour la \textbf{détection de changements} aussi bien que pour la \textbf{correction des modèles} urbains, l'évaluation, et ainsi \textbf{la sélection des algorithmes} de reconstruction les plus adaptées ou encore l'évaluation de la qualité de \textbf{reconstruction par la foule}.\\
    Dans cet article, une nouvelle \textbf{taxonomie d'erreurs} est considérée. Elle est indépendante des démarches de reconstruction $3D$ et flexible quant aux différents types de modèles en entrée. La qualification est donc formulée comme un \textbf{problème de classification supervisée} qui dépend des niveaux de détails recherchés. Une \textbf{référence d'attributs intrinsèques} est calculée à partir de la géométrie des modèles de bâtiments en entrée. L'idée est que notre méthode prenne en entrée les données les moins complexes possibles. Pour un gain en flexibilité, des attributs fondés sur la comparaison avec les orthoimages ou le Modèle Numérique de surface peuvent être aussi pris en compte.

    \section{\'Etat de l'art}

    Différentes méthodes de qualification de modèles $3D$ urbains ont été proposées. Elles peuvent être classées selon les critères sur lesquelles elles s'appuient: indices géométriques de précision ou erreurs sémantiques (topologiques ou géométriques). Les indices géométriques permettent de quantifier la précision d'une modélisation à partir de la précision des points d'intérêts (sommets, point d'intersection \dots), des surfaces ou des volumes des modèles $3D$ en les comparant à des données de références de plus grande précision~\cite{Zeng2014}. Ces indices ne permettent pas de bien décrire les défauts d'une reconstruction et sont, la plupart du temps, trop locaux. Une taxonomie d'erreurs sémantiques est donc préférable. Elle peut reposer sur le paradigme des feux de circulation~\cite{boudet2006supervised} (Correct, Acceptable, Généralisé et Faux), comme elle peut adopter le point de vue des méthodes de reconstruction. Les erreurs sont, par exemple, discriminées en erreurs d'emprise de bâtiments (contour erroné, bâtiment inexistant, cours intérieure manquante et emprise imprécise), en erreurs de reconstruction intinsèques (sous-segmentation, sur-segmentation, toit inexact, translation en Z) à la méthode et en erreur due à l'occlusion végétale~\cite{Michelin2013}. L'évaluation d'un modèle urbain est donc faite grâce une classification supervisée qui prend comme étiquettes les erreurs ainsi définies. Pour caractériser ces modèles d'entrée, des attributs sont calculés à partir des images orientés et Modèle Numérique de Surface (MNS) à très haute résolution spatiale (\SIrange{20}{25}{\cm}), en comparant des segments $3D$ ou des indices de corrélation de texture, par exemple. Dans ce cas de figure, la taxonomie risque d'être trop générale comme elle peut être surajustée par rapport à une scène ou une méthode de reconstruction donnée.

    \section{Méthode proposée}

    La méthode proposée consiste à évaluer un \textit{modèle} $3D$, en prédisant les erreurs qui l'affectent. Ces erreurs sont définies selon une taxonomie hiérarchique. Conformément au besoin de la qualification, nous considérons un certain jeu d'étiquettes correspondantes. Un modèle de classification supervisée est donc entraîné, à partir d'un ensemble de modèles annotés, afin de prédire ensuite la qualité de la modélisation des bâtiments et de préciser les erreurs qui les affectent. Cette méthode flexible décrit les modèles urbains grâce à des attributs géométriques intrinsèques directement dérivés du \textit{modèle} $3D$, auxquelles on peut ajoutter des attributs radiométriques, calculés à partir de l'orthoimage de la scène, ou des attributs altimétriques, en comparant l'altimétrie du modèle au MNS.

    \subsection{Taxonomie d'erreurs}

    Pour classer les erreurs dans la nouvelle taxonomie, deux critères dont pris en compte: le Niveau de Détails ($LoD$) et la \emph{finesse} de l'erreur. La \emph{finesse} représente le niveau de sémantisation des erreurs. Une erreur est dite de \emph{finesse} maximale si elle correspond à une action unitaire de la part d'un opérateur au moment de la correction. On définit ainsi ce que l'on appelera une erreur atomique.\\
    Du point de vue opérationnel, les bâtiments ne sont pas tous qualifiables. En effet, quelques bâtiments peuvent être occultés par la végétation ou se trouver au bord de la région traitée. Dans ces cas pathologiques, nous estimons que la qualification n'est pas un problème bien défini. Nous discriminons, ainsi, entre bâtiments \emph{qualifiables} et bâtiments \emph{non qualifiables}. Cette classification est considérée de \emph{finesse} $0$. Au niveau de \emph{finesse} suivant, les bâtiments sont classés selon s'ils sont \emph{valides} ou \emph{erronés}. Ces derniers sont ensuite divisés selon le Niveau de Détail $LoD$ en famille d'erreurs de \emph{finesse} $2$. En effet, une famille d'erreurs, nommée: \emph{``Erreurs de Bâtiment''}, est consacrée aux défauts qui affectent le bâtiment dans son intégralité (niveau $LoD 0\cup LoD 1$). La famille \emph{``Erreurs de Facettes''} contient les erreurs qui concernent les facettes --- façades ou toit --- des bâtiments (niveau $LoD 2$). La dernière famille, \emph{``Erreurs de Superstructures''}, englobe les erreurs qui atteignent les superstructures reconstruites (niveau $LoD 3$). Ces familles contiennent chacune des erreurs atomiques de \emph{finesse} maximale égale à $3$.\\
    Cette catégorisation est indépendente de la méthode de reconstruction ou de la scène à modéliser. L'étiquetage est non redondant: les erreurs atomiques relevées sont indépendantes entre elles et ne représentent que des défauts particuliers, topologiques ou géométriques. Les erreurs topologiques relèvent les erreurs de structure du modèle reconstruit. Les erreurs géométriques mettent en évidence l'imprécision de la reconstruction. Chaque erreur atomique se voit attribuée une note, au moment de l'annotation, sur une échelle de $0$ à $10$, et représente le degré de confiance en la présence du défaut. Cela revient à une discrétisation de la probabilité d'existence de l'erreur. Les erreurs de finesse inférieure héritent des erreurs de leurs filles (i.e. de \emph{finesse} plus grande). En effet, elles sont aussi sures que les erreurs qu'elles contiennent. Leur note attribuée est donc le maximum des notes des erreurs filles.

    Au moment de la qualification, trois paramètres entrent en jeu: un niveau de $LoD$, un niveau de \emph{finesse} et l'\emph{exclusivité}. En précisant un $LoD$ donné, les erreurs de plus grand Niveau de Détail sont ignorées. En fixant une \emph{finesse} donnée, on ne discrimine que selon les erreurs du même ordre de \emph{finesse}. Le dernier paramètre est l'\emph{exclusivité} des erreurs. Si le problème est hierarchisé, nous ne relevons que la famille d'erreurs représentant le plus petit Niveau de Détail: c'est un problème de classification \textit{Multi-Classes}. Dans le cas contraire, nous rapportons toutes les erreurs: c'est un problème \textit{Multi-\'Etiquettes}.

    On propose les familles d'erreurs suivantes pour le niveau $LoD 2$:

    \begin{enumerate}[label= (\roman*)., itemsep=0pt]
        \item Erreurs de Bâtiment:
        \begin{itemize}[itemsep=0pt]
            \item Sous segmentation: deux bâtiments, ou plus, représentés comme un seul;
            \item Sur segmentation: un bâtiment est modélisé en deux ou plusieurs bâtiments;
            \item Empreinte imprécise: l'emprise du bâtiment inexacte;
            \item Hauteur imprécise: la hauteur du bâtiment est mal estimée;
        \end{itemize}
        \item Erreurs de Facette:
        \begin{itemize}[itemsep=0pt]
            \item Sous segmentation: deux facettes, ou plus, représentées comme une seule;
            \item Sur segmentation: une facette est modélisée en deux ou plusieurs facettes;
            \item Segmentation imprécise: les arêtes qui séparent les facettes sont inexactes;
            \item Pente imprécise: la pente de la facette est inexacte.
        \end{itemize}
    \end{enumerate}

    \subsection{Descripteurs $3D$}

    Nous proposons des attributs de bâtiments les plus simples possibles. Ils sont de deux types. Les \textbf{attributs géométriques} sont calculés à partir de statistiques (histogramme ou une liste contenant le maximum, le minimum, la moyenne, le médian et/ou l'écart type) de quelques propriétés géométriques des facettes du bâtiments: nombre de sommets, aire de la surface, angles entre les normales de facettes adjacentes et/ou toutes les facettes, distance entre les centroides des facettes adjacentes et/ou toutes les facettes. Les \textbf{attributs altimétriques} sont issus d'un histogramme de la différence entre l'estimation du MNS à partir du \textit{modèle} $3D$ et un MNS brut de résolution \SI{0,06}{m}.
    \subsection{Classification}

    Les différents attributs ($\underset{geométriques}{4\times4} + \underset{altimétriques}{5} = 21$) obtenus sont, en suite, concaténés dans un seul vecteur. Nous appliquons des Forêts Aléatoires --- qui peuvent gérer des descripteurs multimodaux --- à $800$ arbres et de profondeur maximale de $4$. Ce classifieur a été adapté, au cas de la classification \emph{Multi-\'Etiquettes}, en utlisant la stratégie Un contre Tous. Nous procédons par $10-fold$ validation croisée en moyennant les notes de test.

    \section{Résultats}

    Nous appliquons notre approche à une surface de $\SI{0,2}{\km \squared}$ contenant $502$ bâtiments dans la ville d'\'Elancourt ($78990$). Les modèles $3D$ sont générés à partir d'une base de données d'emprise cadastrales. L'extrapolation de la topologie du toit se fait en simulant les toits possibles, à partir des images orientées, avant de les confronter à un MNS à $\SI{0,06}{\m}$ de résolution. Les façades du modèle relient la ligne de goutière au sol~\cite{Durupt2006}. On obtient une modélisation $2,5D$ de la scène à un Niveau de Détail $LoD 2$. Nous rapportons, dans le Tableau~\ref{tab::multilab_d3}, des premiers résultats de tests utilisants des attributs géométriques et altimétriques, par validation croisée.\\
    \begin{wraptable}{r}{0.45\textwidth}
        \vspace{-25pt}
        \begin{tabular}{x{2.5cm} x{1cm} x{1cm} x{1cm}}
            \toprule
            {\bf Erreur} & {\bf Précision globale} & {\bf Précision} & {\bf Rappel} \\
            \midrule
            \textbf{Sous Seg. Bât.} & $0,948$ & $0,63$ & $0,868$ \\
            \midrule
            \textbf{Sur Seg. Bât.} & $0,971$ & $0,158$ & $1,00$ \\
            \midrule
            \textbf{Emp. Impr.} & $0,906$ & $0,236$ & $0,929$ \\
            \midrule
            \textbf{Haut. Impr.} & $0,997$ & $0,00$ & $NaN$ \\
            \midrule
            \midrule
            \textbf{Sous Seg. Fac.} & $0,919$ & $0,14$ & $0,41$ \\
            \midrule
            \textbf{Sur Seg. Fac.} & $0,991$ & $1,00$ & $0,988$ \\
            \midrule
            \textbf{Seg. Fac. Impr.} & $0,919$ & $0,00$ & $NaN$\\
            \midrule
            \textbf{Pente Impr.} & $0,974$ & $0,143$ & $1,00$\\
            \bottomrule
        \end{tabular}
        \caption{\label{tab::multilab_d3}Qualification \emph{non exclusive} de \emph{finesse} $ = 3$ et de $LoD 2$.}
        \vspace{-25pt}
    \end{wraptable}
    Nous remarquons que les \textbf{Erreurs de Bâtiments} sont de faible précision comparées aux \textbf{Erreurs de Facettes}. Ceci peut être expliqué par le fait que ces erreurs sont moins présentes dans nos échantillons ($24\%$ parmi les $502$ bâtiments). C'est aussi le cas de \textbf{Pente imprécise}, de \textbf{Segmentation imprécise} et de \textbf{Sous Segmentation} qui sont très mal représentées aussi, avec $6,87\%$, $6,57\%$ et $2,67\%$, respectivement, de présence parmi tous les bâtiments à qualifier. Cette rareté explique aussi pourquoi on obtient des précisions globales proche de $1$ alors que les précisions sont très faibles.



    \section{Conclusion et perspectives}

    Nous avons proposé un nouveau cadre de qualification de modèles $3D$ polyédriques. Il repose sur une taxonomie hiérarchisée d'erreurs sémantiques indépendantes des modèles à qualifier. Nous nous servons d'une classification supervisée d'attributs géométriques et altimétriques des bâtiments reconstruits, afin de prédire les erreurs d'un modèle en entrée. Une démonstration sur $502$ bâtiments donne des résultats mitigés pour des étiquettes qui sont sous représentées. La prochaine étape consiste à ajouter des attributs radiométriques ainsi que l'augmentation de la base d'apprentissage puis d'étudier leur apport respectif. Nous envisageons, enfin, d'explorer l'apprentissage non supervisé ou une approche semi-supervisée afin d'enrichir notre taxonomie et de propager les prédictions sur d'autres zones jamais vues.

    \bibliographystyle{abbrv}
    \bibliography{references}
\end{document}
